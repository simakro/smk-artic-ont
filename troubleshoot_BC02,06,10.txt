(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ snakemake --use-conda --cores 64
['BC02']
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job counts:
        count   jobs
        1       all
        1       canu_correct
        1       convert2fasta
        1       medaka_polishing
        1       porechop_adapter_barcode_trimming
        5
Select jobs to execute...

[Tue Oct  5 14:08:02 2021]
rule porechop_adapter_barcode_trimming:
    input: input_data/BC02.fastq
    output: results/BC02_abtrim, results/BC02_abtrim/BC02.fastq
    jobid: 3
    wildcards: barcode=BC02
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/e16b82bce1a375d87e5e1de31be1785c

Loading reads
input_data/BC02.fastq
44,461 reads loaded


Looking for known adapter sets
10,000 / 10,000 (100.0%)

Barcodes determined to be in reverse orientation
                                        Best               
                                        read       Best    
                                        start      read end
  Set                                   %ID        %ID     
  SQK-NSK007                               100.0       81.8
  Rapid                                     62.7        0.0
  RBK004_upstream                           83.8        0.0
  SQK-MAP006                                76.7       80.0
  SQK-MAP006 short                          72.0       75.0
  PCR adapters 1                            77.3       78.3
  PCR adapters 2                            81.8       80.0
  PCR adapters 3                            79.2       76.9
  1D^2 part 1                               74.1       74.2
  1D^2 part 2                               86.1       73.3
  cDNA SSP                                  72.1       68.3
  Barcode 1 (reverse)                       77.8       76.9
  Barcode 2 (reverse)                      100.0      100.0
  Barcode 3 (reverse)                       80.8       76.9
  Barcode 4 (reverse)                       75.0       76.9
  Barcode 5 (reverse)                       95.8       76.9
  Barcode 6 (reverse)                       76.9       76.9
  Barcode 7 (reverse)                       91.7       74.1
  Barcode 8 (reverse)                       75.0       76.0
  Barcode 9 (reverse)                       76.9       81.5
  Barcode 10 (reverse)                      73.1       74.1
  Barcode 11 (reverse)                      74.1       74.1
  Barcode 12 (reverse)                      80.8       77.8
  Barcode 1 (forward)                       75.0       77.8
  Barcode 2 (forward)                      100.0      100.0
  Barcode 3 (forward)                       78.6       76.0
  Barcode 4 (forward)                       76.0       75.0
  Barcode 5 (forward)                       76.9       75.9
  Barcode 6 (forward)                       79.2       79.2
  Barcode 7 (forward)                       75.0       75.0
  Barcode 8 (forward)                       76.9       76.9
  Barcode 9 (forward)                       76.0       76.9
  Barcode 10 (forward)                      75.0       74.1
  Barcode 11 (forward)                      70.8       72.0
  Barcode 12 (forward)                      79.2       77.8
  Barcode 13 (forward)                      75.0       76.0
  Barcode 14 (forward)                      72.0       72.0
  Barcode 15 (forward)                      76.0       76.0
  Barcode 16 (forward)                      74.1       76.0
  Barcode 17 (forward)                      74.1       73.1
  Barcode 18 (forward)                      75.0       76.9
  Barcode 19 (forward)                      76.0       75.0
  Barcode 20 (forward)                      75.9       76.9
  Barcode 21 (forward)                      76.0       76.0
  Barcode 22 (forward)                      80.0       74.1
  Barcode 23 (forward)                      76.0       76.0
  Barcode 24 (forward)                      77.8       80.8
  Barcode 25 (forward)                      77.8       76.0
  Barcode 26 (forward)                      75.0       76.0
  Barcode 27 (forward)                      74.1       75.0
  Barcode 28 (forward)                      76.0       76.0
  Barcode 29 (forward)                      80.0       80.0
  Barcode 30 (forward)                      76.0       76.0
  Barcode 31 (forward)                      76.9       80.8
  Barcode 32 (forward)                      77.8       75.0
  Barcode 33 (forward)                      75.0       76.9
  Barcode 34 (forward)                      75.0       76.0
  Barcode 35 (forward)                      77.8       76.9
  Barcode 36 (forward)                      72.0       75.0
  Barcode 37 (forward)                      74.1       75.0
  Barcode 38 (forward)                      74.1       75.0
  Barcode 39 (forward)                      75.0       75.0
  Barcode 40 (forward)                      72.0       73.1
  Barcode 41 (forward)                      76.9       77.8
  Barcode 42 (forward)                      80.0       76.9
  Barcode 43 (forward)                      76.0       76.0
  Barcode 44 (forward)                      71.4       74.1
  Barcode 45 (forward)                      73.1       76.0
  Barcode 46 (forward)                      75.0       73.1
  Barcode 47 (forward)                      76.0       73.1
  Barcode 48 (forward)                      76.0       80.0
  Barcode 49 (forward)                      76.0       79.2
  Barcode 50 (forward)                      76.9       73.1
  Barcode 51 (forward)                      73.1       74.1
  Barcode 52 (forward)                      75.0       80.8
  Barcode 53 (forward)                      76.0       76.9
  Barcode 54 (forward)                      79.2       76.0
  Barcode 55 (forward)                      76.9       75.0
  Barcode 56 (forward)                      79.2       82.1
  Barcode 57 (forward)                      73.1       73.1
  Barcode 58 (forward)                      74.1       73.1
  Barcode 59 (forward)                      75.0       76.0
  Barcode 60 (forward)                      76.0       79.2
  Barcode 61 (forward)                      75.0       73.1
  Barcode 62 (forward)                      79.2       80.0
  Barcode 63 (forward)                      75.0       75.0
  Barcode 64 (forward)                      87.5       80.0
  Barcode 65 (forward)                      76.0       76.0
  Barcode 66 (forward)                      77.8       76.0
  Barcode 67 (forward)                      76.0       76.0
  Barcode 68 (forward)                      79.2       79.2
  Barcode 69 (forward)                      76.9       80.0
  Barcode 70 (forward)                      73.1       76.9
  Barcode 71 (forward)                      74.1       76.0
  Barcode 72 (forward)                      76.0       73.1
  Barcode 73 (forward)                      80.8       78.6
  Barcode 74 (forward)                      76.0       79.2
  Barcode 75 (forward)                      75.0       76.9
  Barcode 76 (forward)                      80.0       79.2
  Barcode 77 (forward)                      76.0       77.8
  Barcode 78 (forward)                      79.2       76.0
  Barcode 79 (forward)                      73.1       75.0
  Barcode 80 (forward)                      75.0       73.1
  Barcode 81 (forward)                      79.2       76.0
  Barcode 82 (forward)                      75.0       79.2
  Barcode 83 (forward)                      74.1       75.0
  Barcode 84 (forward)                      73.1       75.0
  Barcode 85 (forward)                      76.0       75.0
  Barcode 86 (forward)                      75.0       76.9
  Barcode 87 (forward)                      73.1       76.9
  Barcode 88 (forward)                      76.9       73.1
  Barcode 89 (forward)                      77.8       79.2
  Barcode 90 (forward)                      72.0       72.0
  Barcode 91 (forward)                      80.8       76.0
  Barcode 92 (forward)                      76.9       72.0
  Barcode 93 (forward)                      75.0       77.8
  Barcode 94 (forward)                      83.3       84.0
  Barcode 95 (forward)                      73.1       76.0
  Barcode 96 (forward)                      74.1       75.0


Trimming adapters from read ends
     SQK-NSK007_Y_Top: AATGTACTTCGTTCAGTTACGTATTGCT
  SQK-NSK007_Y_Bottom: GCAATACGTAACTGAACGAAGT
             BC02_rev: ACAGACGACTACAAACGGAATCGA
                 BC02: TCGATTCCGTTTGTAGTCGTCTGT
             BC05_rev: AAGGTTACACAAACCCTGGACAAG
                 BC05: CTTGTCCAGGGTTTGTGTAACCTT
             BC07_rev: AAGGATTCATTCCCACGGTAACAC
                 BC07: GTGTTACCGTGGGAATGAATCCTT
                 BC02: TCGATTCCGTTTGTAGTCGTCTGT
             BC02_rev: ACAGACGACTACAAACGGAATCGA
           NB02_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAACAGACGACTACAAACGGAATCGACAGCACCT
             NB02_end: AGGTGCTGTCGATTCCGTTTGTAGTCGTCTGTTTAACCTTAGCAATACGTAACTGAACGAAGT
           NB05_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAAAGGTTACACAAACCCTGGACAAGCAGCACCT
             NB05_end: AGGTGCTGCTTGTCCAGGGTTTGTGTAACCTTTTAACCTTAGCAATACGTAACTGAACGAAGT
           NB07_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAAAGGATTCATTCCCACGGTAACACCAGCACCT
             NB07_end: AGGTGCTGGTGTTACCGTGGGAATGAATCCTTTTAACCTTAGCAATACGTAACTGAACGAAGT

44,461 / 44,461 (100.0%)

44,450 / 44,461 reads had adapters trimmed from their start (3,118,024 bp removed)
44,322 / 44,461 reads had adapters trimmed from their end (2,385,671 bp removed)


Discarding reads containing middle adapters
44,461 / 44,461 (100.0%)

364 / 44,461 reads were discarded based on middle adapters


Saving trimmed reads to barcode-specific files

  Barcode  Reads   Bases       File                          
  BC02     44,058  16,953,724  results/BC02_abtrim/BC02.fastq
  none         20       7,825  results/BC02_abtrim/none.fastq

[Tue Oct  5 14:10:38 2021]
Finished job 3.
1 of 5 steps (20%) done
Select jobs to execute...

[Tue Oct  5 14:10:38 2021]
rule convert2fasta:
    input: results/BC02_abtrim/BC02.fastq
    output: results/BC02_ab_fa/BC02.fasta
    jobid: 2
    wildcards: barcode=BC02

Waiting at most 5 seconds for missing files.
MissingOutputException in line 59 of /home/simon/smk-artic-ont/smk-artic-ont/workflow/Snakefile:
Job Missing files after 5 seconds:
results/BC02_ab_fa/BC02.fasta
This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait.
Job id: 2 completed successfully, but some output files are missing. 2
  File "/home/simon/mambaforge/envs/snakemake/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 584, in handle_job_success
  File "/home/simon/mambaforge/envs/snakemake/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 252, in handle_job_success
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/log/2021-10-05T140802.513529.snakemake.log
(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ 

#######################################################

(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ snakemake --use-conda --cores 64
['BC10']
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job counts:
        count   jobs
        1       all
        1       canu_correct
        1       convert2fasta
        1       medaka_polishing
        1       porechop_adapter_barcode_trimming
        5
Select jobs to execute...

[Tue Oct  5 14:23:16 2021]
rule porechop_adapter_barcode_trimming:
    input: input_data/BC10.fastq
    output: results/BC10_abtrim, results/BC10_abtrim/BC10.fastq
    jobid: 3
    wildcards: barcode=BC10
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/e16b82bce1a375d87e5e1de31be1785c

Loading reads
input_data/BC10.fastq
34,895 reads loaded


Looking for known adapter sets
10,000 / 10,000 (100.0%)

Barcodes determined to be in forward orientation
                                        Best               
                                        read       Best    
                                        start      read end
  Set                                   %ID        %ID     
  SQK-NSK007                               100.0       86.4
  Rapid                                     63.5        0.0
  RBK004_upstream                           78.4        0.0
  SQK-MAP006                                75.0       83.3
  SQK-MAP006 short                          76.0       75.0
  PCR adapters 1                            78.3       77.3
  PCR adapters 2                            79.2       83.3
  PCR adapters 3                            76.9       76.0
  1D^2 part 1                               74.1       71.4
  1D^2 part 2                               88.2       80.6
  cDNA SSP                                  69.8       69.0
  Barcode 1 (reverse)                       75.0       79.2
  Barcode 2 (reverse)                       78.6       75.0
  Barcode 3 (reverse)                       76.9       75.0
  Barcode 4 (reverse)                       76.0       73.1
  Barcode 5 (reverse)                       79.2       88.5
  Barcode 6 (reverse)                       80.0       79.2
  Barcode 7 (reverse)                       76.0       74.1
  Barcode 8 (reverse)                       75.0       76.0
  Barcode 9 (reverse)                       76.9       76.9
  Barcode 10 (reverse)                     100.0      100.0
  Barcode 11 (reverse)                      76.0       75.0
  Barcode 12 (reverse)                      80.8       78.6
  Barcode 1 (forward)                       74.1       76.0
  Barcode 2 (forward)                       75.0       79.2
  Barcode 3 (forward)                       79.2       76.0
  Barcode 4 (forward)                       74.1       76.0
  Barcode 5 (forward)                       75.0       74.1
  Barcode 6 (forward)                       79.2       80.0
  Barcode 7 (forward)                       75.0       75.0
  Barcode 8 (forward)                       76.0       95.8
  Barcode 9 (forward)                       75.0       80.0
  Barcode 10 (forward)                      88.5      100.0
  Barcode 11 (forward)                      75.0       74.1
  Barcode 12 (forward)                      77.8       77.8
  Barcode 13 (forward)                      76.0       79.2
  Barcode 14 (forward)                      76.0       72.0
  Barcode 15 (forward)                      75.9       76.9
  Barcode 16 (forward)                      76.9       74.1
  Barcode 17 (forward)                      79.2       74.1
  Barcode 18 (forward)                      73.1       76.9
  Barcode 19 (forward)                      76.0       77.8
  Barcode 20 (forward)                      76.0       75.0
  Barcode 21 (forward)                      76.0       79.2
  Barcode 22 (forward)                      76.9       73.1
  Barcode 23 (forward)                      76.0       79.2
  Barcode 24 (forward)                      77.8       78.6
  Barcode 25 (forward)                      76.9       76.9
  Barcode 26 (forward)                      76.0       76.0
  Barcode 27 (forward)                      75.0       75.0
  Barcode 28 (forward)                      75.0       73.1
  Barcode 29 (forward)                      80.0       84.0
  Barcode 30 (forward)                      74.1       75.0
  Barcode 31 (forward)                      76.9       80.0
  Barcode 32 (forward)                      79.2       75.0
  Barcode 33 (forward)                      73.1       76.0
  Barcode 34 (forward)                      75.0       76.9
  Barcode 35 (forward)                      78.6       74.1
  Barcode 36 (forward)                      76.0       76.9
  Barcode 37 (forward)                      76.0       76.0
  Barcode 38 (forward)                      75.0       80.0
  Barcode 39 (forward)                      76.0       75.0
  Barcode 40 (forward)                      70.8       75.0
  Barcode 41 (forward)                      75.0       75.0
  Barcode 42 (forward)                      74.1       76.9
  Barcode 43 (forward)                      75.0       76.0
  Barcode 44 (forward)                      75.0       75.0
  Barcode 45 (forward)                      73.1       76.0
  Barcode 46 (forward)                      75.0       76.0
  Barcode 47 (forward)                      73.1       75.0
  Barcode 48 (forward)                      74.1       76.0
  Barcode 49 (forward)                      74.1       76.9
  Barcode 50 (forward)                      76.0       73.1
  Barcode 51 (forward)                      75.0       75.0
  Barcode 52 (forward)                      76.9       76.9
  Barcode 53 (forward)                      76.9       80.0
  Barcode 54 (forward)                      80.0       79.2
  Barcode 55 (forward)                      72.0       75.0
  Barcode 56 (forward)                      76.9       79.2
  Barcode 57 (forward)                      73.1       79.2
  Barcode 58 (forward)                      72.0       73.1
  Barcode 59 (forward)                      77.8       75.0
  Barcode 60 (forward)                      75.0       73.1
  Barcode 61 (forward)                      76.0       75.0
  Barcode 62 (forward)                      75.0       77.8
  Barcode 63 (forward)                      75.0       73.1
  Barcode 64 (forward)                      75.0       77.8
  Barcode 65 (forward)                      76.0       75.0
  Barcode 66 (forward)                      76.0       76.0
  Barcode 67 (forward)                      76.9       76.9
  Barcode 68 (forward)                      75.0       75.0
  Barcode 69 (forward)                      79.2       76.0
  Barcode 70 (forward)                      72.0       73.1
  Barcode 71 (forward)                      74.1       75.0
  Barcode 72 (forward)                      79.2       76.0
  Barcode 73 (forward)                      75.0       74.1
  Barcode 74 (forward)                      76.9       77.8
  Barcode 75 (forward)                      76.9       74.1
  Barcode 76 (forward)                      76.9       79.2
  Barcode 77 (forward)                      75.0       74.1
  Barcode 78 (forward)                      79.2       76.0
  Barcode 79 (forward)                      73.1       74.1
  Barcode 80 (forward)                      72.0       76.0
  Barcode 81 (forward)                      79.2       80.8
  Barcode 82 (forward)                      76.0       76.9
  Barcode 83 (forward)                      73.1       75.0
  Barcode 84 (forward)                      75.0       76.0
  Barcode 85 (forward)                      75.0       75.0
  Barcode 86 (forward)                      76.0       76.0
  Barcode 87 (forward)                      76.9       76.9
  Barcode 88 (forward)                      75.0       75.0
  Barcode 89 (forward)                      77.8       79.2
  Barcode 90 (forward)                      74.1       72.0
  Barcode 91 (forward)                      76.9       73.1
  Barcode 92 (forward)                      76.0       73.1
  Barcode 93 (forward)                      84.6       81.5
  Barcode 94 (forward)                      80.0       83.3
  Barcode 95 (forward)                      72.4       77.8
  Barcode 96 (forward)                      73.1       75.0


Trimming adapters from read ends
     SQK-NSK007_Y_Top: AATGTACTTCGTTCAGTTACGTATTGCT
  SQK-NSK007_Y_Bottom: GCAATACGTAACTGAACGAAGT
             BC10_rev: GAGAGGACAAAGGTTTCAACGCTT
                 BC10: AAGCGTTGAAACCTTTGTCCTCTC
                 BC08: TTCAGGGAACAAACCAAGTTACGT
             BC08_rev: ACGTAACTTGGTTTGTTCCCTGAA
                 BC10: AAGCGTTGAAACCTTTGTCCTCTC
             BC10_rev: GAGAGGACAAAGGTTTCAACGCTT
           NB10_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAGAGAGGACAAAGGTTTCAACGCTTCAGCACCT
             NB10_end: AGGTGCTGAAGCGTTGAAACCTTTGTCCTCTCTTAACCTTAGCAATACGTAACTGAACGAAGT

34,895 / 34,895 (100.0%)

34,884 / 34,895 reads had adapters trimmed from their start (2,421,830 bp removed)
34,705 / 34,895 reads had adapters trimmed from their end (1,926,346 bp removed)


Discarding reads containing middle adapters
34,895 / 34,895 (100.0%)

100 / 34,895 reads were discarded based on middle adapters


Saving trimmed reads to barcode-specific files

  Barcode  Reads   Bases       File                          
  none     34,790  13,226,592  results/BC10_abtrim/none.fastq

Waiting at most 5 seconds for missing files.
MissingOutputException in line 34 of /home/simon/smk-artic-ont/smk-artic-ont/workflow/Snakefile:
Job Missing files after 5 seconds:
results/BC10_abtrim/BC10.fastq
This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait.
Job id: 3 completed successfully, but some output files are missing. 3
  File "/home/simon/mambaforge/envs/snakemake/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 584, in handle_job_success
  File "/home/simon/mambaforge/envs/snakemake/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 252, in handle_job_success
Removing output files of failed job porechop_adapter_barcode_trimming since they might be corrupted:
results/BC10_abtrim
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/log/2021-10-05T142315.901521.snakemake.log


###################################################
BC10 without --required-barcode-bothends flag in porechop
###################################################

(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ snakemake --use-conda --cores 64
['BC10']
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job counts:
        count   jobs
        1       all
        1       canu_correct
        1       convert2fasta
        1       medaka_polishing
        1       porechop_adapter_barcode_trimming
        5
Select jobs to execute...

[Tue Oct  5 14:26:31 2021]
rule porechop_adapter_barcode_trimming:
    input: input_data/BC10.fastq
    output: results/BC10_abtrim, results/BC10_abtrim/BC10.fastq
    jobid: 3
    wildcards: barcode=BC10
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/e16b82bce1a375d87e5e1de31be1785c

Loading reads
input_data/BC10.fastq
34,895 reads loaded


Looking for known adapter sets
10,000 / 10,000 (100.0%)

Barcodes determined to be in forward orientation
                                        Best               
                                        read       Best    
                                        start      read end
  Set                                   %ID        %ID     
  SQK-NSK007                               100.0       86.4
  Rapid                                     63.5        0.0
  RBK004_upstream                           78.4        0.0
  SQK-MAP006                                75.0       83.3
  SQK-MAP006 short                          76.0       75.0
  PCR adapters 1                            78.3       77.3
  PCR adapters 2                            79.2       83.3
  PCR adapters 3                            76.9       76.0
  1D^2 part 1                               74.1       71.4
  1D^2 part 2                               88.2       80.6
  cDNA SSP                                  69.8       69.0
  Barcode 1 (reverse)                       75.0       79.2
  Barcode 2 (reverse)                       78.6       75.0
  Barcode 3 (reverse)                       76.9       75.0
  Barcode 4 (reverse)                       76.0       73.1
  Barcode 5 (reverse)                       79.2       88.5
  Barcode 6 (reverse)                       80.0       79.2
  Barcode 7 (reverse)                       76.0       74.1
  Barcode 8 (reverse)                       75.0       76.0
  Barcode 9 (reverse)                       76.9       76.9
  Barcode 10 (reverse)                     100.0      100.0
  Barcode 11 (reverse)                      76.0       75.0
  Barcode 12 (reverse)                      80.8       78.6
  Barcode 1 (forward)                       74.1       76.0
  Barcode 2 (forward)                       75.0       79.2
  Barcode 3 (forward)                       79.2       76.0
  Barcode 4 (forward)                       74.1       76.0
  Barcode 5 (forward)                       75.0       74.1
  Barcode 6 (forward)                       79.2       80.0
  Barcode 7 (forward)                       75.0       75.0
  Barcode 8 (forward)                       76.0       95.8
  Barcode 9 (forward)                       75.0       80.0
  Barcode 10 (forward)                      88.5      100.0
  Barcode 11 (forward)                      75.0       74.1
  Barcode 12 (forward)                      77.8       77.8
  Barcode 13 (forward)                      76.0       79.2
  Barcode 14 (forward)                      76.0       72.0
  Barcode 15 (forward)                      75.9       76.9
  Barcode 16 (forward)                      76.9       74.1
  Barcode 17 (forward)                      79.2       74.1
  Barcode 18 (forward)                      73.1       76.9
  Barcode 19 (forward)                      76.0       77.8
  Barcode 20 (forward)                      76.0       75.0
  Barcode 21 (forward)                      76.0       79.2
  Barcode 22 (forward)                      76.9       73.1
  Barcode 23 (forward)                      76.0       79.2
  Barcode 24 (forward)                      77.8       78.6
  Barcode 25 (forward)                      76.9       76.9
  Barcode 26 (forward)                      76.0       76.0
  Barcode 27 (forward)                      75.0       75.0
  Barcode 28 (forward)                      75.0       73.1
  Barcode 29 (forward)                      80.0       84.0
  Barcode 30 (forward)                      74.1       75.0
  Barcode 31 (forward)                      76.9       80.0
  Barcode 32 (forward)                      79.2       75.0
  Barcode 33 (forward)                      73.1       76.0
  Barcode 34 (forward)                      75.0       76.9
  Barcode 35 (forward)                      78.6       74.1
  Barcode 36 (forward)                      76.0       76.9
  Barcode 37 (forward)                      76.0       76.0
  Barcode 38 (forward)                      75.0       80.0
  Barcode 39 (forward)                      76.0       75.0
  Barcode 40 (forward)                      70.8       75.0
  Barcode 41 (forward)                      75.0       75.0
  Barcode 42 (forward)                      74.1       76.9
  Barcode 43 (forward)                      75.0       76.0
  Barcode 44 (forward)                      75.0       75.0
  Barcode 45 (forward)                      73.1       76.0
  Barcode 46 (forward)                      75.0       76.0
  Barcode 47 (forward)                      73.1       75.0
  Barcode 48 (forward)                      74.1       76.0
  Barcode 49 (forward)                      74.1       76.9
  Barcode 50 (forward)                      76.0       73.1
  Barcode 51 (forward)                      75.0       75.0
  Barcode 52 (forward)                      76.9       76.9
  Barcode 53 (forward)                      76.9       80.0
  Barcode 54 (forward)                      80.0       79.2
  Barcode 55 (forward)                      72.0       75.0
  Barcode 56 (forward)                      76.9       79.2
  Barcode 57 (forward)                      73.1       79.2
  Barcode 58 (forward)                      72.0       73.1
  Barcode 59 (forward)                      77.8       75.0
  Barcode 60 (forward)                      75.0       73.1
  Barcode 61 (forward)                      76.0       75.0
  Barcode 62 (forward)                      75.0       77.8
  Barcode 63 (forward)                      75.0       73.1
  Barcode 64 (forward)                      75.0       77.8
  Barcode 65 (forward)                      76.0       75.0
  Barcode 66 (forward)                      76.0       76.0
  Barcode 67 (forward)                      76.9       76.9
  Barcode 68 (forward)                      75.0       75.0
  Barcode 69 (forward)                      79.2       76.0
  Barcode 70 (forward)                      72.0       73.1
  Barcode 71 (forward)                      74.1       75.0
  Barcode 72 (forward)                      79.2       76.0
  Barcode 73 (forward)                      75.0       74.1
  Barcode 74 (forward)                      76.9       77.8
  Barcode 75 (forward)                      76.9       74.1
  Barcode 76 (forward)                      76.9       79.2
  Barcode 77 (forward)                      75.0       74.1
  Barcode 78 (forward)                      79.2       76.0
  Barcode 79 (forward)                      73.1       74.1
  Barcode 80 (forward)                      72.0       76.0
  Barcode 81 (forward)                      79.2       80.8
  Barcode 82 (forward)                      76.0       76.9
  Barcode 83 (forward)                      73.1       75.0
  Barcode 84 (forward)                      75.0       76.0
  Barcode 85 (forward)                      75.0       75.0
  Barcode 86 (forward)                      76.0       76.0
  Barcode 87 (forward)                      76.9       76.9
  Barcode 88 (forward)                      75.0       75.0
  Barcode 89 (forward)                      77.8       79.2
  Barcode 90 (forward)                      74.1       72.0
  Barcode 91 (forward)                      76.9       73.1
  Barcode 92 (forward)                      76.0       73.1
  Barcode 93 (forward)                      84.6       81.5
  Barcode 94 (forward)                      80.0       83.3
  Barcode 95 (forward)                      72.4       77.8
  Barcode 96 (forward)                      73.1       75.0


Trimming adapters from read ends
     SQK-NSK007_Y_Top: AATGTACTTCGTTCAGTTACGTATTGCT
  SQK-NSK007_Y_Bottom: GCAATACGTAACTGAACGAAGT
             BC10_rev: GAGAGGACAAAGGTTTCAACGCTT
                 BC10: AAGCGTTGAAACCTTTGTCCTCTC
                 BC08: TTCAGGGAACAAACCAAGTTACGT
             BC08_rev: ACGTAACTTGGTTTGTTCCCTGAA
                 BC10: AAGCGTTGAAACCTTTGTCCTCTC
             BC10_rev: GAGAGGACAAAGGTTTCAACGCTT
           NB10_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAGAGAGGACAAAGGTTTCAACGCTTCAGCACCT
             NB10_end: AGGTGCTGAAGCGTTGAAACCTTTGTCCTCTCTTAACCTTAGCAATACGTAACTGAACGAAGT

34,895 / 34,895 (100.0%)

34,884 / 34,895 reads had adapters trimmed from their start (2,421,830 bp removed)
34,705 / 34,895 reads had adapters trimmed from their end (1,926,346 bp removed)


Discarding reads containing middle adapters
34,895 / 34,895 (100.0%)

100 / 34,895 reads were discarded based on middle adapters


Saving trimmed reads to barcode-specific files

  Barcode  Reads   Bases       File                          
  BC08         40      13,045  results/BC10_abtrim/BC08.fastq
  BC10         21       7,122  results/BC10_abtrim/BC10.fastq
  none     34,729  13,206,425  results/BC10_abtrim/none.fastq

[Tue Oct  5 14:28:23 2021]
Finished job 3.
1 of 5 steps (20%) done
Select jobs to execute...

[Tue Oct  5 14:28:23 2021]
rule convert2fasta:
    input: results/BC10_abtrim/BC10.fastq
    output: results/BC10_ab_fa/BC10.fasta
    jobid: 2
    wildcards: barcode=BC10

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/c6b025516a3a11e93936b967c43c0616
[Tue Oct  5 14:28:23 2021]
Finished job 2.
2 of 5 steps (40%) done
Select jobs to execute...

[Tue Oct  5 14:28:23 2021]
rule canu_correct:
    input: results/BC10_ab_fa/BC10.fasta
    output: results/BC10_corr, results/BC10_corr/BC10.correctedReads.fasta.gz
    jobid: 1
    wildcards: barcode=BC10
    threads: 6

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631

[Tue Oct  5 14:28:23 2021]
rule medaka_polishing:
    input: results/BC10_abtrim/BC10.fastq, results/BC10_ab_fa/BC10.fasta
    output: results/BC10_polish/medaka, results/BC10_polish/medaka/consensus.fasta
    jobid: 4
    wildcards: barcode=BC10
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/2b9bcfdf06b6bcef5f04049c68651625
-- WARNING:
-- WARNING:  Option '-nanopore-raw <files>' is deprecated.
-- WARNING:  Use option '-nanopore <files>' in the future.
-- WARNING:
-- canu branch HEAD +0 changes (r10117 5638f7d9a5379373310ab62c28aa0cdbd864722d)
--
-- CITATIONS
--
-- For 'standard' assemblies of PacBio or Nanopore reads:
--   Koren S, Walenz BP, Berlin K, Miller JR, Phillippy AM.
--   Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation.
--   Genome Res. 2017 May;27(5):722-736.
--   http://doi.org/10.1101/gr.215087.116
-- 
-- Read and contig alignments during correction and consensus use:
--   Šošic M, Šikic M.
--   Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance.
--   Bioinformatics. 2017 May 1;33(9):1394-1395.
--   http://doi.org/10.1093/bioinformatics/btw753
-- 
-- Overlaps are generated using:
--   Li H.
--   Minimap2: pairwise alignment for nucleotide sequences.
--   arXiv.org. 2017 Aug 4.
--   https://arxiv.org/abs/1708.01492
-- 
-- Corrected read consensus sequences are generated using an algorithm derived from FALCON-sense:
--   Chin CS, et al.
--   Phased diploid genome assembly with single-molecule real-time sequencing.
--   Nat Methods. 2016 Dec;13(12):1050-1054.
--   http://doi.org/10.1038/nmeth.4035
-- 
-- Contig consensus sequences are generated using an algorithm derived from pbdagcon:
--   Chin CS, et al.
--   Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data.
--   Nat Methods. 2013 Jun;10(6):563-9
--   http://doi.org/10.1038/nmeth.2474
-- 
-- CONFIGURE CANU
--
-- Detected minimap2 version '2.22-r1101' (from 'minimap2').
--
-- WARNING:
-- WARNING:  Failed to run gnuplot using command 'gnuplot'.
-- WARNING:  Plots will be disabled.
-- WARNING:
--
-- Detected 64 CPUs and 188 gigabytes of memory.
-- No grid engine detected, grid and staging disabled.
--
--                                (tag)Concurrency
--                         (tag)Threads          |
--                (tag)Memory         |          |
--        (tag)             |         |          |       total usage      algorithm
--        -------  ----------  --------   --------  --------------------  -----------------------------
-- Local: meryl     11.000 GB    4 CPUs x  16 jobs   176.000 GB  64 CPUs  (k-mer counting)
-- Local: hap        8.000 GB    4 CPUs x  16 jobs   128.000 GB  64 CPUs  (read-to-haplotype assignment)
-- Local: cormmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: obtmmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: utgmmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: cor        8.000 GB    4 CPUs x  16 jobs   128.000 GB  64 CPUs  (read correction)
-- Local: ovb        4.000 GB    1 CPU  x  47 jobs   188.000 GB  47 CPUs  (overlap store bucketizer)
-- Local: ovs        8.000 GB    1 CPU  x  23 jobs   184.000 GB  23 CPUs  (overlap store sorting)
-- Local: red       11.000 GB    4 CPUs x  16 jobs   176.000 GB  64 CPUs  (read error detection)
-- Local: oea        8.000 GB    1 CPU  x  23 jobs   184.000 GB  23 CPUs  (overlap error adjustment)
-- Local: bat       16.000 GB    4 CPUs x   1 job     16.000 GB   4 CPUs  (contig construction with bogart)
-- Local: cns        -.--- GB    4 CPUs x   - jobs     -.--- GB   - CPUs  (consensus)
--
-- Found untrimmed raw Nanopore reads in the input files.
--
-- Generating assembly 'BC10' in '/home/simon/smk-artic-ont/smk-artic-ont/results/BC10_corr':
--    - only correct raw reads.
--
-- Parameters:
--
--  genomeSize        30000
--
--  Overlap Generation Limits:
--    corOvlErrorRate 0.3200 ( 32.00%)
--    obtOvlErrorRate 0.1200 ( 12.00%)
--    utgOvlErrorRate 0.1200 ( 12.00%)
--
--  Overlap Processing Limits:
--    corErrorRate    0.5000 ( 50.00%)
--    obtErrorRate    0.1200 ( 12.00%)
--    utgErrorRate    0.1200 ( 12.00%)
--    cnsErrorRate    0.2000 ( 20.00%)
--
--
-- BEGIN CORRECTION
--
----------------------------------------
-- Starting command on Tue Oct  5 14:28:23 2021 with 781.806 GB free disk space

    cd .
    ./BC10.seqStore.sh \
    > ./BC10.seqStore.err 2>&1

-- Finished on Tue Oct  5 14:28:23 2021 (fast as lightning) with 781.806 GB free disk space
----------------------------------------
----------------------------------------
-- Starting command on Tue Oct  5 14:28:23 2021 with 781.806 GB free disk space

    cd .
    /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631/bin/sqStoreDumpMetaData \
      -S ./BC10.seqStore \
      -raw \
      -histogram \
      -lengths \
    > ./BC10.seqStore/readlengths-cor.dat \
    2> ./BC10.seqStore/readlengths-cor.err 
    

-- Finished on Tue Oct  5 14:28:23 2021 (lickety-split) with 781.806 GB free disk space
----------------------------------------
--
-- WARNING: gnuplot failed.
--
----------------------------------------
----------------------------------------
-- Starting command on Tue Oct  5 14:28:23 2021 with 781.806 GB free disk space

    cd .
    /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631/bin/sqStoreDumpMetaData \
      -S ./BC10.seqStore \
      -raw \
      -histogram \
    > ./BC10.seqStore/readlengths-cor.txt \
    2> ./BC10.seqStore/readlengths-cor.err 
    

-- Finished on Tue Oct  5 14:28:23 2021 (furiously fast) with 781.806 GB free disk space
----------------------------------------
--
-- In sequence store './BC10.seqStore':
--   Found 16 reads.
--   Found 6699 bases (0.22 times coverage).
--    
--    G=6699                             sum of  ||               length     num
--    NG         length     index       lengths  ||                range    seqs
--    ----- ------------ --------- ------------  ||  ------------------- -------
--    00010         1012         0         1012  ||        294-308             2|---------------------
--    00020          581         1         1593  ||        309-323             0|
--    00030          387         3         2394  ||        324-338             0|
--    00040          386         4         2780  ||        339-353             0|
--    00050          380         6         3543  ||        354-368             6|---------------------------------------------------------------
--    00060          368         8         4286  ||        369-383             3|--------------------------------
--    00070          367        10         5021  ||        384-398             2|---------------------
--    00080          365        11         5386  ||        399-413             0|
--    00090          355        13         6098  ||        414-428             1|-----------
--    00100          294        15         6699  ||        429-443             0|
--    001.000x                  16         6699  ||        444-458             0|
--                                               ||        459-473             0|
--                                               ||        474-488             0|
--                                               ||        489-503             0|
--                                               ||        504-518             0|
--                                               ||        519-533             0|
--                                               ||        534-548             0|
--                                               ||        549-563             0|
--                                               ||        564-578             0|
--                                               ||        579-593             1|-----------
--                                               ||        594-608             0|
--                                               ||        609-623             0|
--                                               ||        624-638             0|
--                                               ||        639-653             0|
--                                               ||        654-668             0|
--                                               ||        669-683             0|
--                                               ||        684-698             0|
--                                               ||        699-713             0|
--                                               ||        714-728             0|
--                                               ||        729-743             0|
--                                               ||        744-758             0|
--                                               ||        759-773             0|
--                                               ||        774-788             0|
--                                               ||        789-803             0|
--                                               ||        804-818             0|
--                                               ||        819-833             0|
--                                               ||        834-848             0|
--                                               ||        849-863             0|
--                                               ||        864-878             0|
--                                               ||        879-893             0|
--                                               ||        894-908             0|
--                                               ||        909-923             0|
--                                               ||        924-938             0|
--                                               ||        939-953             0|
--                                               ||        954-968             0|
--                                               ||        969-983             0|
--                                               ||        984-998             0|
--                                               ||        999-1013            1|-----------
--    
--
-- ERROR:  Read coverage (0.22) lower than allowed.
-- ERROR:    minInputCoverage  = 10
-- ERROR:    stopOnLowCoverage = 10
-- ERROR:
-- ERROR:  This could be caused by an incorrect genomeSize or poor quality
-- ERROR:  reads that cound not be sufficiently corrected.
-- ERROR:
-- ERROR:  You can force Canu to continue by decreasing parameters
-- ERROR:  minInputCoverage and/or stopOnLowCoverage.  Be warned that the
-- ERROR:  quality of corrected reads and/or contiguity of contigs will be poor.
-- 

ABORT:
ABORT: canu branch HEAD +0 changes (r10117 5638f7d9a5379373310ab62c28aa0cdbd864722d)
ABORT: Don't panic, but a mostly harmless error occurred and Canu stopped.
ABORT: Try restarting.  If that doesn't work, ask for help.
ABORT:
[Tue Oct  5 14:28:23 2021]
Error in rule canu_correct:
    jobid: 1
    output: results/BC10_corr, results/BC10_corr/BC10.correctedReads.fasta.gz
    conda-env: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631
    shell:
        canu -correct -nanopore-raw results/BC10_ab_fa/BC10.fasta -p BC10 -d results/BC10_corr genomeSize=30k corOverlapper=minimap utgOverlapper=minimap obtOverlapper=minimap minOverlapLength=10 minReadLength=200 corMMapMerSize=10 corOutCoverage=50000 corMinCoverage=0 maxInputCoverage=20000
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job canu_correct since they might be corrupted:
results/BC10_corr
Checking program versions
This is medaka 1.0.3
Program    Version    Required   Pass     
bcftools   1.10.2     1.9        True     
bgzip      1.10.2     1.9        True     
minimap2   2.22       2.11       True     
samtools   1.10       1.9        True     
tabix      1.10.2     1.9        True     
Warning: Output results/BC10_polish/medaka already exists, may use old results.
Aligning basecalls to draft
Removing previous index file /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi
Removing previous index file /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.fai
Constructing minimap index.
[M::mm_idx_gen::0.004*1.51] collected minimizers
[M::mm_idx_gen::0.007*2.06] sorted minimizers
[M::main::0.010*1.74] loaded/built the index for 1 target sequence(s)
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.011*1.71] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -I 16G -x map-ont --MD -d /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta
[M::main] Real time: 0.012 sec; CPU: 0.019 sec; Peak RSS: 0.004 GB
[M::main::0.006*1.29] loaded/built the index for 1 target sequence(s)
[M::mm_mapopt_update::0.007*1.27] mid_occ = 10
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.007*1.26] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::worker_pipeline::0.013*1.72] mapped 21 sequences
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -x map-ont --MD -t 4 -a -A 2 -B 4 -O 4,24 -E 2,1 /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi /home/simon/smk-artic-ont/smk-artic-ont/results/BC10_abtrim/BC10.fastq
[M::main] Real time: 0.014 sec; CPU: 0.023 sec; Peak RSS: 0.006 GB
Running medaka consensus
[14:28:29 - Predict] Processing region(s): MN908947.3:0-29903
[14:28:29 - Predict] Setting tensorflow threads to 4.
[14:28:29 - Predict] Processing 1 long region(s) with batching.
[14:28:29 - Predict] Using model: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/2b9bcfdf06b6bcef5f04049c68651625/lib/python3.6/site-packages/medaka/data/r941_min_high_g360_model.hdf5.
[14:28:29 - ModelLoad] Building model with cudnn optimization: False
[14:28:29 - DLoader] Initializing data loader
[14:28:29 - PWorker] Running inference for 0.0M draft bases.
[14:28:29 - Sampler] Initializing sampler for consensus of region MN908947.3:0-29903.
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 32-404.
[14:28:29 - Feature] Processed MN908947.3:32.0-404.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 2183-2261.
[14:28:29 - Feature] Processed MN908947.3:2183.0-2261.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 4060-4421.
[14:28:29 - Feature] Processed MN908947.3:4060.0-4421.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 4648-4954.
[14:28:29 - Feature] Processed MN908947.3:4648.0-4954.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 6169-6550.
[14:28:29 - Feature] Processed MN908947.3:6169.0-6550.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 8601-8980.
[14:28:29 - Feature] Processed MN908947.3:8601.0-8980.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 10367-10760.
[14:28:29 - Feature] Processed MN908947.3:10367.0-10760.0 (median depth 2.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 10998-11391.
[14:28:29 - Feature] Processed MN908947.3:10998.0-11391.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 13612-13981.
[14:28:29 - Feature] Processed MN908947.3:13612.0-13981.0 (median depth 2.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 17387-17449.
[14:28:29 - Feature] Processed MN908947.3:17387.0-17449.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 21660-22035.
[14:28:29 - Feature] Processed MN908947.3:21660.0-22035.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 23791-24166.
[14:28:29 - Feature] Processed MN908947.3:23791.0-24166.0 (median depth 2.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 26840-27210.
[14:28:29 - Feature] Processed MN908947.3:26840.0-27210.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 27786-28168.
[14:28:29 - Feature] Processed MN908947.3:27786.0-28168.0 (median depth 1.0)
[14:28:29 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 28679-29690.
[14:28:29 - Feature] Processed MN908947.3:28679.0-29690.0 (median depth 1.0)
[14:28:29 - Sampler] Took 0.02s to make features.
[14:28:29 - Sampler] Region MN908947.3:32.0-404.0 (375 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:2183.0-2261.0 (79 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:4060.0-4421.0 (362 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:4648.0-4954.0 (308 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:6169.0-6550.0 (383 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:8601.0-8980.0 (380 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:10367.0-10760.0 (399 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:10998.0-11391.0 (395 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:13612.0-13981.0 (375 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:17387.0-17449.0 (63 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:21660.0-22035.0 (379 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:23791.0-24166.0 (377 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:26840.0-27210.0 (377 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:27786.0-28168.0 (383 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:29 - Sampler] Region MN908947.3:28679.0-29690.0 (1031 positions) is smaller than inference chunk length 10000, quarantining.
[14:28:30 - PWorker] All done, 15 remainder regions.
[14:28:30 - Predict] Processing 15 short region(s).
[14:28:30 - ModelLoad] Building model with cudnn optimization: False
[14:28:30 - DLoader] Initializing data loader
[14:28:30 - PWorker] Running inference for 0.0M draft bases.
[14:28:30 - Sampler] Initializing sampler for consensus of region MN908947.3:32-405.
[14:28:30 - Feature] Processed MN908947.3:32.0-404.0 (median depth 1.0)
[14:28:30 - Sampler] Took 0.00s to make features.
[14:28:31 - PWorker] All done, 0 remainder regions.
[14:28:31 - DLoader] Initializing data loader
[14:28:31 - PWorker] Running inference for 0.0M draft bases.
[14:28:31 - Sampler] Initializing sampler for consensus of region MN908947.3:2183-2262.
[14:28:31 - Feature] Processed MN908947.3:2183.0-2261.0 (median depth 1.0)
[14:28:31 - Sampler] Took 0.00s to make features.
[14:28:31 - PWorker] All done, 0 remainder regions.
[14:28:31 - DLoader] Initializing data loader
[14:28:31 - PWorker] Running inference for 0.0M draft bases.
[14:28:31 - Sampler] Initializing sampler for consensus of region MN908947.3:4060-4422.
[14:28:31 - Feature] Processed MN908947.3:4060.0-4421.0 (median depth 1.0)
[14:28:31 - Sampler] Took 0.00s to make features.
[14:28:31 - PWorker] All done, 0 remainder regions.
[14:28:31 - DLoader] Initializing data loader
[14:28:31 - PWorker] Running inference for 0.0M draft bases.
[14:28:31 - Sampler] Initializing sampler for consensus of region MN908947.3:4648-4955.
[14:28:31 - Feature] Processed MN908947.3:4648.0-4954.0 (median depth 1.0)
[14:28:31 - Sampler] Took 0.00s to make features.
[14:28:31 - PWorker] All done, 0 remainder regions.
[14:28:31 - DLoader] Initializing data loader
[14:28:31 - PWorker] Running inference for 0.0M draft bases.
[14:28:31 - Sampler] Initializing sampler for consensus of region MN908947.3:6169-6551.
[14:28:31 - Feature] Processed MN908947.3:6169.0-6550.0 (median depth 1.0)
[14:28:31 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:8601-8981.
[14:28:32 - Feature] Processed MN908947.3:8601.0-8980.0 (median depth 1.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:10367-10761.
[14:28:32 - Feature] Processed MN908947.3:10367.0-10760.0 (median depth 2.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:10998-11392.
[14:28:32 - Feature] Processed MN908947.3:10998.0-11391.0 (median depth 1.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:13612-13982.
[14:28:32 - Feature] Processed MN908947.3:13612.0-13981.0 (median depth 2.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:17387-17450.
[14:28:32 - Feature] Processed MN908947.3:17387.0-17449.0 (median depth 1.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:32 - PWorker] All done, 0 remainder regions.
[14:28:32 - DLoader] Initializing data loader
[14:28:32 - PWorker] Running inference for 0.0M draft bases.
[14:28:32 - Sampler] Initializing sampler for consensus of region MN908947.3:21660-22036.
[14:28:32 - Feature] Processed MN908947.3:21660.0-22035.0 (median depth 1.0)
[14:28:32 - Sampler] Took 0.00s to make features.
[14:28:33 - PWorker] All done, 0 remainder regions.
[14:28:33 - DLoader] Initializing data loader
[14:28:33 - PWorker] Running inference for 0.0M draft bases.
[14:28:33 - Sampler] Initializing sampler for consensus of region MN908947.3:23791-24167.
[14:28:33 - Feature] Processed MN908947.3:23791.0-24166.0 (median depth 2.0)
[14:28:33 - Sampler] Took 0.00s to make features.
[14:28:33 - PWorker] All done, 0 remainder regions.
[14:28:33 - DLoader] Initializing data loader
[14:28:33 - PWorker] Running inference for 0.0M draft bases.
[14:28:33 - Sampler] Initializing sampler for consensus of region MN908947.3:26840-27211.
[14:28:33 - Feature] Processed MN908947.3:26840.0-27210.0 (median depth 1.0)
[14:28:33 - Sampler] Took 0.00s to make features.
[14:28:33 - PWorker] All done, 0 remainder regions.
[14:28:33 - DLoader] Initializing data loader
[14:28:33 - PWorker] Running inference for 0.0M draft bases.
[14:28:33 - Sampler] Initializing sampler for consensus of region MN908947.3:27786-28169.
[14:28:33 - Feature] Processed MN908947.3:27786.0-28168.0 (median depth 1.0)
[14:28:33 - Sampler] Took 0.00s to make features.
[14:28:33 - PWorker] All done, 0 remainder regions.
[14:28:33 - DLoader] Initializing data loader
[14:28:33 - PWorker] Running inference for 0.0M draft bases.
[14:28:33 - Sampler] Initializing sampler for consensus of region MN908947.3:28679-29691.
[14:28:33 - Feature] Processed MN908947.3:28679.0-29690.0 (median depth 1.0)
[14:28:33 - Sampler] Took 0.00s to make features.
[14:28:34 - PWorker] All done, 0 remainder regions.
[14:28:34 - Predict] Finished processing all regions.
Using medaka stitch to create consensus.
[14:28:35 - DataIndex] Loaded 1/1 (100.00%) sample files.
[14:28:35 - Stitch] Stitching regions: ['MN908947.3:0-']
[14:28:35 - DataIndex] Loaded 1/1 (100.00%) sample files.
[14:28:35 - Stitch] Processing MN908947.3:0-.
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:32.0-404.0 and MN908947.3:2183.0-2261.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:2183.0-2261.0 and MN908947.3:4060.0-4421.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:4060.0-4421.0 and MN908947.3:4648.0-4954.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:4648.0-4954.0 and MN908947.3:6169.0-6550.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:6169.0-6550.0 and MN908947.3:8601.0-8980.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:8601.0-8980.0 and MN908947.3:10367.0-10760.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:10367.0-10760.0 and MN908947.3:10998.0-11391.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:10998.0-11391.0 and MN908947.3:13612.0-13981.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:13612.0-13981.0 and MN908947.3:17387.0-17449.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:17387.0-17449.0 and MN908947.3:21660.0-22035.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:21660.0-22035.0 and MN908947.3:23791.0-24166.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:23791.0-24166.0 and MN908947.3:26840.0-27210.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:26840.0-27210.0 and MN908947.3:27786.0-28168.0
[14:28:35 - Stitch] There is no overlap betwen MN908947.3:27786.0-28168.0 and MN908947.3:28679.0-29690.0
[14:28:35 - Stitch] Used heuristic 0 times for MN908947.3:0-.
Polished assembly written to results/BC10_polish/medaka/consensus.fasta, have a nice day.
[Tue Oct  5 14:28:35 2021]
Finished job 4.
3 of 5 steps (60%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/log/2021-10-05T142630.848352.snakemake.log
(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ 


#########################################
BC011 demultiplexing binning problem
#########################################
(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ snakemake --use-conda --cores 64
['BC11']
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job counts:
        count   jobs
        1       all
        1       canu_correct
        1       convert2fasta
        1       medaka_polishing
        1       porechop_adapter_barcode_trimming
        5
Select jobs to execute...

[Tue Oct  5 15:01:23 2021]
rule porechop_adapter_barcode_trimming:
    input: input_data/BC11.fastq
    output: results/BC11_abtrim, results/BC11_abtrim/BC11.fastq
    jobid: 3
    wildcards: barcode=BC11
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/e16b82bce1a375d87e5e1de31be1785c

Loading reads
input_data/BC11.fastq
51,003 reads loaded


Looking for known adapter sets
10,000 / 10,000 (100.0%)

Barcodes determined to be in forward orientation
                                        Best               
                                        read       Best    
                                        start      read end
  Set                                   %ID        %ID     
  SQK-NSK007                               100.0       81.8
  Rapid                                     62.5        0.0
  RBK004_upstream                           82.1        0.0
  SQK-MAP006                                75.9       78.3
  SQK-MAP006 short                          72.0       76.0
  PCR adapters 1                            77.3       79.2
  PCR adapters 2                            78.3       78.3
  PCR adapters 3                            76.0       80.0
  1D^2 part 1                               75.0       71.9
  1D^2 part 2                               85.7       76.5
  cDNA SSP                                  65.9       67.5
  Barcode 1 (reverse)                       75.0       76.9
  Barcode 2 (reverse)                       76.0       77.8
  Barcode 3 (reverse)                       79.2       83.3
  Barcode 4 (reverse)                       74.1       73.1
  Barcode 5 (reverse)                       76.0       76.9
  Barcode 6 (reverse)                       76.0       76.9
  Barcode 7 (reverse)                       75.0       75.0
  Barcode 8 (reverse)                       76.0       76.0
  Barcode 9 (reverse)                       77.8       77.8
  Barcode 10 (reverse)                      76.0       95.8
  Barcode 11 (reverse)                     100.0      100.0
  Barcode 12 (reverse)                      80.8       81.5
  Barcode 1 (forward)                       73.1       76.0
  Barcode 2 (forward)                       76.0       79.2
  Barcode 3 (forward)                       73.1       75.0
  Barcode 4 (forward)                       79.2       75.0
  Barcode 5 (forward)                       76.9       74.1
  Barcode 6 (forward)                       79.2       80.0
  Barcode 7 (forward)                       76.0       76.0
  Barcode 8 (forward)                       76.0      100.0
  Barcode 9 (forward)                       79.2       77.8
  Barcode 10 (forward)                      80.0       79.2
  Barcode 11 (forward)                      88.0      100.0
  Barcode 12 (forward)                      77.8       77.8
  Barcode 13 (forward)                      76.0       76.0
  Barcode 14 (forward)                      73.1       76.0
  Barcode 15 (forward)                      76.0       75.0
  Barcode 16 (forward)                      73.1       75.0
  Barcode 17 (forward)                      72.4       74.1
  Barcode 18 (forward)                      79.2       76.0
  Barcode 19 (forward)                      76.0       76.0
  Barcode 20 (forward)                      75.9       76.9
  Barcode 21 (forward)                      76.0       76.0
  Barcode 22 (forward)                      76.0       76.0
  Barcode 23 (forward)                      76.0       76.0
  Barcode 24 (forward)                      77.8       77.8
  Barcode 25 (forward)                      76.0       76.0
  Barcode 26 (forward)                      76.0       76.0
  Barcode 27 (forward)                      75.0       76.0
  Barcode 28 (forward)                      83.3       83.3
  Barcode 29 (forward)                      80.0       80.0
  Barcode 30 (forward)                      73.1       75.0
  Barcode 31 (forward)                      76.9       79.2
  Barcode 32 (forward)                      75.0       75.0
  Barcode 33 (forward)                      74.1       76.9
  Barcode 34 (forward)                      75.0       75.0
  Barcode 35 (forward)                      78.6       76.0
  Barcode 36 (forward)                      74.1       76.9
  Barcode 37 (forward)                      76.0       76.0
  Barcode 38 (forward)                      76.0       75.0
  Barcode 39 (forward)                      73.1       76.9
  Barcode 40 (forward)                      72.0       73.1
  Barcode 41 (forward)                      75.0       76.0
  Barcode 42 (forward)                      75.0       76.9
  Barcode 43 (forward)                      76.9       76.0
  Barcode 44 (forward)                      73.1       76.0
  Barcode 45 (forward)                      76.0       75.0
  Barcode 46 (forward)                      75.0       79.2
  Barcode 47 (forward)                      76.0       76.0
  Barcode 48 (forward)                      73.1       76.0
  Barcode 49 (forward)                      76.9       76.9
  Barcode 50 (forward)                      75.0       73.1
  Barcode 51 (forward)                      74.1       73.1
  Barcode 52 (forward)                      75.0       76.0
  Barcode 53 (forward)                      73.1       76.0
  Barcode 54 (forward)                      76.9       79.2
  Barcode 55 (forward)                      72.0       75.0
  Barcode 56 (forward)                      76.9       76.9
  Barcode 57 (forward)                      76.0       76.9
  Barcode 58 (forward)                      74.1       73.1
  Barcode 59 (forward)                      75.9       76.0
  Barcode 60 (forward)                      75.0       79.2
  Barcode 61 (forward)                      73.1       76.9
  Barcode 62 (forward)                      76.9       81.5
  Barcode 63 (forward)                      73.1       75.0
  Barcode 64 (forward)                      76.0       79.2
  Barcode 65 (forward)                      76.9       74.1
  Barcode 66 (forward)                      76.9       76.0
  Barcode 67 (forward)                      76.0       80.8
  Barcode 68 (forward)                      75.9       75.0
  Barcode 69 (forward)                      75.0       76.0
  Barcode 70 (forward)                      74.1       76.9
  Barcode 71 (forward)                      74.1       76.9
  Barcode 72 (forward)                      76.9       75.0
  Barcode 73 (forward)                      74.1       73.1
  Barcode 74 (forward)                      80.0       75.0
  Barcode 75 (forward)                      75.0       75.0
  Barcode 76 (forward)                      76.9       76.9
  Barcode 77 (forward)                      77.8       79.2
  Barcode 78 (forward)                      79.2       80.0
  Barcode 79 (forward)                      73.1       76.9
  Barcode 80 (forward)                      72.0       73.1
  Barcode 81 (forward)                      76.0       80.8
  Barcode 82 (forward)                      75.0       76.0
  Barcode 83 (forward)                      72.0       74.1
  Barcode 84 (forward)                      77.8       76.9
  Barcode 85 (forward)                      75.0       75.0
  Barcode 86 (forward)                      75.0       73.1
  Barcode 87 (forward)                      74.1       75.0
  Barcode 88 (forward)                      73.1       75.0
  Barcode 89 (forward)                      76.9       79.2
  Barcode 90 (forward)                      72.0       73.1
  Barcode 91 (forward)                      73.1       74.1
  Barcode 92 (forward)                      76.0       72.0
  Barcode 93 (forward)                      75.0       77.8
  Barcode 94 (forward)                      80.0       83.3
  Barcode 95 (forward)                      76.0       76.9
  Barcode 96 (forward)                      75.0       74.1


Trimming adapters from read ends
     SQK-NSK007_Y_Top: AATGTACTTCGTTCAGTTACGTATTGCT
  SQK-NSK007_Y_Bottom: GCAATACGTAACTGAACGAAGT
             BC10_rev: GAGAGGACAAAGGTTTCAACGCTT
                 BC10: AAGCGTTGAAACCTTTGTCCTCTC
             BC11_rev: TCCATTCCCTCCGATAGATGAAAC
                 BC11: GTTTCATCTATCGGAGGGAATGGA
                 BC08: TTCAGGGAACAAACCAAGTTACGT
             BC08_rev: ACGTAACTTGGTTTGTTCCCTGAA
                 BC11: GTTTCATCTATCGGAGGGAATGGA
             BC11_rev: TCCATTCCCTCCGATAGATGAAAC
           NB10_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAAGAGAGGACAAAGGTTTCAACGCTTCAGCACCT
             NB10_end: AGGTGCTGAAGCGTTGAAACCTTTGTCCTCTCTTAACCTTAGCAATACGTAACTGAACGAAGT
           NB11_start: AATGTACTTCGTTCAGTTACGTATTGCTAAGGTTAATCCATTCCCTCCGATAGATGAAACCAGCACCT
             NB11_end: AGGTGCTGGTTTCATCTATCGGAGGGAATGGATTAACCTTAGCAATACGTAACTGAACGAAGT

51,003 / 51,003 (100.0%)

50,986 / 51,003 reads had adapters trimmed from their start (3,573,832 bp removed)
50,888 / 51,003 reads had adapters trimmed from their end (2,752,801 bp removed)


Discarding reads containing middle adapters
51,003 / 51,003 (100.0%)

476 / 51,003 reads were discarded based on middle adapters


Saving trimmed reads to barcode-specific files

  Barcode  Reads   Bases       File                          
  BC08         59      19,234  results/BC11_abtrim/BC08.fastq
  BC11         18       4,296  results/BC11_abtrim/BC11.fastq
  none     50,444  19,624,344  results/BC11_abtrim/none.fastq

[Tue Oct  5 15:03:55 2021]
Finished job 3.
1 of 5 steps (20%) done
Select jobs to execute...

[Tue Oct  5 15:03:55 2021]
rule convert2fasta:
    input: results/BC11_abtrim/BC11.fastq
    output: results/BC11_ab_fa/BC11.fasta
    jobid: 2
    wildcards: barcode=BC11

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/c6b025516a3a11e93936b967c43c0616
[Tue Oct  5 15:03:55 2021]
Finished job 2.
2 of 5 steps (40%) done
Select jobs to execute...

[Tue Oct  5 15:03:55 2021]
rule canu_correct:
    input: results/BC11_ab_fa/BC11.fasta
    output: results/BC11_corr, results/BC11_corr/BC11.correctedReads.fasta.gz
    jobid: 1
    wildcards: barcode=BC11
    threads: 6


Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631
[Tue Oct  5 15:03:55 2021]
rule medaka_polishing:
    input: results/BC11_abtrim/BC11.fastq, results/BC11_ab_fa/BC11.fasta
    output: results/BC11_polish/medaka, results/BC11_polish/medaka/consensus.fasta
    jobid: 4
    wildcards: barcode=BC11
    threads: 4

Activating conda environment: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/2b9bcfdf06b6bcef5f04049c68651625
-- canu branch HEAD +0 changes (r10117 5638f7d9a5379373310ab62c28aa0cdbd864722d)
--
-- CITATIONS
--
-- For 'standard' assemblies of PacBio or Nanopore reads:
--   Koren S, Walenz BP, Berlin K, Miller JR, Phillippy AM.
--   Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation.
--   Genome Res. 2017 May;27(5):722-736.
--   http://doi.org/10.1101/gr.215087.116
-- 
-- Read and contig alignments during correction and consensus use:
--   Šošic M, Šikic M.
--   Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance.
--   Bioinformatics. 2017 May 1;33(9):1394-1395.
--   http://doi.org/10.1093/bioinformatics/btw753
-- 
-- Overlaps are generated using:
--   Li H.
--   Minimap2: pairwise alignment for nucleotide sequences.
--   arXiv.org. 2017 Aug 4.
--   https://arxiv.org/abs/1708.01492
-- 
-- Corrected read consensus sequences are generated using an algorithm derived from FALCON-sense:
--   Chin CS, et al.
--   Phased diploid genome assembly with single-molecule real-time sequencing.
--   Nat Methods. 2016 Dec;13(12):1050-1054.
--   http://doi.org/10.1038/nmeth.4035
-- 
-- Contig consensus sequences are generated using an algorithm derived from pbdagcon:
--   Chin CS, et al.
--   Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data.
--   Nat Methods. 2013 Jun;10(6):563-9
--   http://doi.org/10.1038/nmeth.2474
-- 
-- CONFIGURE CANU
--
-- Detected minimap2 version '2.22-r1101' (from 'minimap2').
--
-- WARNING:
-- WARNING:  Failed to run gnuplot using command 'gnuplot'.
-- WARNING:  Plots will be disabled.
-- WARNING:
--
-- Detected 64 CPUs and 188 gigabytes of memory.
-- No grid engine detected, grid and staging disabled.
--
--                                (tag)Concurrency
--                         (tag)Threads          |
--                (tag)Memory         |          |
--        (tag)             |         |          |       total usage      algorithm
--        -------  ----------  --------   --------  --------------------  -----------------------------
-- Local: meryl     11.000 GB    4 CPUs x  16 jobs   176.000 GB  64 CPUs  (k-mer counting)
-- Local: hap        8.000 GB    4 CPUs x  16 jobs   128.000 GB  64 CPUs  (read-to-haplotype assignment)
-- Local: cormmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: obtmmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: utgmmap    6.000 GB   16 CPUs x   4 jobs    24.000 GB  64 CPUs  (overlap detection with minimap)
-- Local: cor        8.000 GB    4 CPUs x  16 jobs   128.000 GB  64 CPUs  (read correction)
-- Local: ovb        4.000 GB    1 CPU  x  47 jobs   188.000 GB  47 CPUs  (overlap store bucketizer)
-- Local: ovs        8.000 GB    1 CPU  x  23 jobs   184.000 GB  23 CPUs  (overlap store sorting)
-- Local: red       11.000 GB    4 CPUs x  16 jobs   176.000 GB  64 CPUs  (read error detection)
-- Local: oea        8.000 GB    1 CPU  x  23 jobs   184.000 GB  23 CPUs  (overlap error adjustment)
-- Local: bat       16.000 GB    4 CPUs x   1 job     16.000 GB   4 CPUs  (contig construction with bogart)
-- Local: cns        -.--- GB    4 CPUs x   - jobs     -.--- GB   - CPUs  (consensus)
--
-- Found untrimmed raw Nanopore reads in the input files.
--
-- Generating assembly 'BC11' in '/home/simon/smk-artic-ont/smk-artic-ont/results/BC11_corr':
--    - only correct raw reads.
--
-- Parameters:
--
--  genomeSize        30000
--
--  Overlap Generation Limits:
--    corOvlErrorRate 0.3200 ( 32.00%)
--    obtOvlErrorRate 0.1200 ( 12.00%)
--    utgOvlErrorRate 0.1200 ( 12.00%)
--
--  Overlap Processing Limits:
--    corErrorRate    0.5000 ( 50.00%)
--    obtErrorRate    0.1200 ( 12.00%)
--    utgErrorRate    0.1200 ( 12.00%)
--    cnsErrorRate    0.2000 ( 20.00%)
--
--
-- BEGIN CORRECTION
--
----------------------------------------
-- Starting command on Tue Oct  5 15:03:55 2021 with 781.848 GB free disk space

    cd .
    ./BC11.seqStore.sh \
    > ./BC11.seqStore.err 2>&1

-- Finished on Tue Oct  5 15:03:56 2021 (one second) with 781.848 GB free disk space
----------------------------------------
----------------------------------------
-- Starting command on Tue Oct  5 15:03:56 2021 with 781.848 GB free disk space

    cd .
    /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631/bin/sqStoreDumpMetaData \
      -S ./BC11.seqStore \
      -raw \
      -histogram \
      -lengths \
    > ./BC11.seqStore/readlengths-cor.dat \
    2> ./BC11.seqStore/readlengths-cor.err 
    

-- Finished on Tue Oct  5 15:03:56 2021 (like a bat out of hell) with 781.848 GB free disk space
----------------------------------------
--
-- WARNING: gnuplot failed.
--
----------------------------------------
----------------------------------------
-- Starting command on Tue Oct  5 15:03:56 2021 with 781.848 GB free disk space

    cd .
    /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631/bin/sqStoreDumpMetaData \
      -S ./BC11.seqStore \
      -raw \
      -histogram \
    > ./BC11.seqStore/readlengths-cor.txt \
    2> ./BC11.seqStore/readlengths-cor.err 
    

-- Finished on Tue Oct  5 15:03:56 2021 (furiously fast) with 781.848 GB free disk space
----------------------------------------
--
-- In sequence store './BC11.seqStore':
--   Found 11 reads.
--   Found 4137 bases (0.13 times coverage).
--    
--    G=4137                             sum of  ||               length     num
--    NG         length     index       lengths  ||                range    seqs
--    ----- ------------ --------- ------------  ||  ------------------- -------
--    00010          415         0          415  ||        285-287             1|--------------------------------
--    00020          395         2         1207  ||        288-290             0|
--    00030          395         3         1602  ||        291-293             0|
--    00040          390         4         1992  ||        294-296             0|
--    00050          389         5         2381  ||        297-299             0|
--    00060          383         6         2764  ||        300-302             0|
--    00070          378         7         3142  ||        303-305             0|
--    00080          369         8         3511  ||        306-308             0|
--    00090          341         9         3852  ||        309-311             0|
--    00100          285        10         4137  ||        312-314             0|
--    001.000x                  11         4137  ||        315-317             0|
--                                               ||        318-320             0|
--                                               ||        321-323             0|
--                                               ||        324-326             0|
--                                               ||        327-329             0|
--                                               ||        330-332             0|
--                                               ||        333-335             0|
--                                               ||        336-338             0|
--                                               ||        339-341             1|--------------------------------
--                                               ||        342-344             0|
--                                               ||        345-347             0|
--                                               ||        348-350             0|
--                                               ||        351-353             0|
--                                               ||        354-356             0|
--                                               ||        357-359             0|
--                                               ||        360-362             0|
--                                               ||        363-365             0|
--                                               ||        366-368             0|
--                                               ||        369-371             1|--------------------------------
--                                               ||        372-374             0|
--                                               ||        375-377             0|
--                                               ||        378-380             1|--------------------------------
--                                               ||        381-383             1|--------------------------------
--                                               ||        384-386             0|
--                                               ||        387-389             1|--------------------------------
--                                               ||        390-392             1|--------------------------------
--                                               ||        393-395             2|---------------------------------------------------------------
--                                               ||        396-398             1|--------------------------------
--                                               ||        399-401             0|
--                                               ||        402-404             0|
--                                               ||        405-407             0|
--                                               ||        408-410             0|
--                                               ||        411-413             0|
--                                               ||        414-416             1|--------------------------------
--    
--
-- ERROR:  Read coverage (0.13) lower than allowed.
-- ERROR:    minInputCoverage  = 10
-- ERROR:    stopOnLowCoverage = 10
-- ERROR:
-- ERROR:  This could be caused by an incorrect genomeSize or poor quality
-- ERROR:  reads that cound not be sufficiently corrected.
-- ERROR:
-- ERROR:  You can force Canu to continue by decreasing parameters
-- ERROR:  minInputCoverage and/or stopOnLowCoverage.  Be warned that the
-- ERROR:  quality of corrected reads and/or contiguity of contigs will be poor.
-- 

ABORT:
ABORT: canu branch HEAD +0 changes (r10117 5638f7d9a5379373310ab62c28aa0cdbd864722d)
ABORT: Don't panic, but a mostly harmless error occurred and Canu stopped.
ABORT: Try restarting.  If that doesn't work, ask for help.
ABORT:
[Tue Oct  5 15:03:56 2021]
Error in rule canu_correct:
    jobid: 1
    output: results/BC11_corr, results/BC11_corr/BC11.correctedReads.fasta.gz
    conda-env: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/597b98d07c2ba3a86f466a8952c1a631
    shell:
        canu -correct -nanopore results/BC11_ab_fa/BC11.fasta -p BC11 -d results/BC11_corr genomeSize=30k corOverlapper=minimap utgOverlapper=minimap obtOverlapper=minimap minOverlapLength=10 minReadLength=200 corMMapMerSize=10 corOutCoverage=50000 corMinCoverage=0 maxInputCoverage=20000
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job canu_correct since they might be corrupted:
results/BC11_corr
Checking program versions
This is medaka 1.0.3
Program    Version    Required   Pass     
bcftools   1.10.2     1.9        True     
bgzip      1.10.2     1.9        True     
minimap2   2.22       2.11       True     
samtools   1.10       1.9        True     
tabix      1.10.2     1.9        True     
Warning: Output results/BC11_polish/medaka already exists, may use old results.
Aligning basecalls to draft
Removing previous index file /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi
Removing previous index file /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.fai
Constructing minimap index.
[M::mm_idx_gen::0.006*1.31] collected minimizers
[M::mm_idx_gen::0.008*1.79] sorted minimizers
[M::main::0.011*1.57] loaded/built the index for 1 target sequence(s)
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.012*1.54] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -I 16G -x map-ont --MD -d /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta
[M::main] Real time: 0.013 sec; CPU: 0.020 sec; Peak RSS: 0.004 GB
[M::main::0.006*1.24] loaded/built the index for 1 target sequence(s)
[M::mm_mapopt_update::0.007*1.21] mid_occ = 10
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.007*1.19] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::worker_pipeline::0.010*1.65] mapped 18 sequences
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -x map-ont --MD -t 4 -a -A 2 -B 4 -O 4,24 -E 2,1 /home/simon/smk-artic-ont/smk-artic-ont/resources/MN908947.3_SARS-CoV2_Wuhan-reference.fasta.mmi /home/simon/smk-artic-ont/smk-artic-ont/results/BC11_abtrim/BC11.fastq
[M::main] Real time: 0.012 sec; CPU: 0.019 sec; Peak RSS: 0.005 GB
Running medaka consensus
[15:04:01 - Predict] Processing region(s): MN908947.3:0-29903
[15:04:01 - Predict] Setting tensorflow threads to 4.
[15:04:01 - Predict] Processing 1 long region(s) with batching.
[15:04:01 - Predict] Using model: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/conda/2b9bcfdf06b6bcef5f04049c68651625/lib/python3.6/site-packages/medaka/data/r941_min_high_g360_model.hdf5.
[15:04:01 - ModelLoad] Building model with cudnn optimization: False
[15:04:02 - DLoader] Initializing data loader
[15:04:02 - PWorker] Running inference for 0.0M draft bases.
[15:04:02 - Sampler] Initializing sampler for consensus of region MN908947.3:0-29903.
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 4046-4421.
[15:04:02 - Feature] Processed MN908947.3:4046.0-4421.0 (median depth 2.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 9216-9582.
[15:04:02 - Feature] Processed MN908947.3:9216.0-9582.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 10360-10523.
[15:04:02 - Feature] Processed MN908947.3:10360.0-10523.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 11867-12255.
[15:04:02 - Feature] Processed MN908947.3:11867.0-12255.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 12423-12799.
[15:04:02 - Feature] Processed MN908947.3:12423.0-12799.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 13920-13983.
[15:04:02 - Feature] Processed MN908947.3:13920.0-13983.0 (median depth 2.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 15486-15883.
[15:04:02 - Feature] Processed MN908947.3:15486.0-15883.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 18643-18975.
[15:04:02 - Feature] Processed MN908947.3:18643.0-18975.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 20474-20885.
[15:04:02 - Feature] Processed MN908947.3:20474.0-20885.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 22518-22900.
[15:04:02 - Feature] Processed MN908947.3:22518.0-22900.0 (median depth 1.0)
[15:04:02 - Feature] Pileup counts do not span requested region, requested MN908947.3:0-29903, received 28985-29375.
[15:04:02 - Feature] Processed MN908947.3:28985.0-29375.0 (median depth 1.0)
[15:04:02 - Sampler] Took 0.01s to make features.
[15:04:02 - Sampler] Region MN908947.3:4046.0-4421.0 (387 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:9216.0-9582.0 (375 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:10360.0-10523.0 (164 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:11867.0-12255.0 (389 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:12423.0-12799.0 (380 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:13920.0-13983.0 (64 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:15486.0-15883.0 (399 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:18643.0-18975.0 (338 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:20474.0-20885.0 (412 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:22518.0-22900.0 (384 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - Sampler] Region MN908947.3:28985.0-29375.0 (392 positions) is smaller than inference chunk length 10000, quarantining.
[15:04:02 - PWorker] All done, 11 remainder regions.
[15:04:02 - Predict] Processing 11 short region(s).
[15:04:02 - ModelLoad] Building model with cudnn optimization: False
[15:04:03 - DLoader] Initializing data loader
[15:04:03 - PWorker] Running inference for 0.0M draft bases.
[15:04:03 - Sampler] Initializing sampler for consensus of region MN908947.3:4046-4422.
[15:04:03 - Feature] Processed MN908947.3:4046.0-4421.0 (median depth 2.0)
[15:04:03 - Sampler] Took 0.00s to make features.
[15:04:03 - PWorker] All done, 0 remainder regions.
[15:04:03 - DLoader] Initializing data loader
[15:04:03 - PWorker] Running inference for 0.0M draft bases.
[15:04:03 - Sampler] Initializing sampler for consensus of region MN908947.3:9216-9583.
[15:04:03 - Feature] Processed MN908947.3:9216.0-9582.0 (median depth 1.0)
[15:04:03 - Sampler] Took 0.00s to make features.
[15:04:03 - PWorker] All done, 0 remainder regions.
[15:04:03 - DLoader] Initializing data loader
[15:04:03 - PWorker] Running inference for 0.0M draft bases.
[15:04:03 - Sampler] Initializing sampler for consensus of region MN908947.3:10360-10524.
[15:04:03 - Feature] Processed MN908947.3:10360.0-10523.0 (median depth 1.0)
[15:04:03 - Sampler] Took 0.00s to make features.
[15:04:04 - PWorker] All done, 0 remainder regions.
[15:04:04 - DLoader] Initializing data loader
[15:04:04 - Sampler] Initializing sampler for consensus of region MN908947.3:11867-12256.
[15:04:04 - PWorker] Running inference for 0.0M draft bases.
[15:04:04 - Feature] Processed MN908947.3:11867.0-12255.0 (median depth 1.0)
[15:04:04 - Sampler] Took 0.00s to make features.
[15:04:04 - PWorker] All done, 0 remainder regions.
[15:04:04 - DLoader] Initializing data loader
[15:04:04 - Sampler] Initializing sampler for consensus of region MN908947.3:12423-12800.
[15:04:04 - PWorker] Running inference for 0.0M draft bases.
[15:04:04 - Feature] Processed MN908947.3:12423.0-12799.0 (median depth 1.0)
[15:04:04 - Sampler] Took 0.00s to make features.
[15:04:04 - PWorker] All done, 0 remainder regions.
[15:04:04 - DLoader] Initializing data loader
[15:04:04 - PWorker] Running inference for 0.0M draft bases.
[15:04:04 - Sampler] Initializing sampler for consensus of region MN908947.3:13920-13984.
[15:04:04 - Feature] Processed MN908947.3:13920.0-13983.0 (median depth 2.0)
[15:04:04 - Sampler] Took 0.00s to make features.
[15:04:04 - PWorker] All done, 0 remainder regions.
[15:04:04 - DLoader] Initializing data loader
[15:04:04 - PWorker] Running inference for 0.0M draft bases.
[15:04:04 - Sampler] Initializing sampler for consensus of region MN908947.3:15486-15884.
[15:04:04 - Feature] Processed MN908947.3:15486.0-15883.0 (median depth 1.0)
[15:04:04 - Sampler] Took 0.00s to make features.
[15:04:04 - PWorker] All done, 0 remainder regions.
[15:04:04 - DLoader] Initializing data loader
[15:04:04 - Sampler] Initializing sampler for consensus of region MN908947.3:18643-18976.
[15:04:04 - PWorker] Running inference for 0.0M draft bases.
[15:04:04 - Feature] Processed MN908947.3:18643.0-18975.0 (median depth 1.0)
[15:04:04 - Sampler] Took 0.00s to make features.
[15:04:05 - PWorker] All done, 0 remainder regions.
[15:04:05 - DLoader] Initializing data loader
[15:04:05 - Sampler] Initializing sampler for consensus of region MN908947.3:20474-20886.
[15:04:05 - PWorker] Running inference for 0.0M draft bases.
[15:04:05 - Feature] Processed MN908947.3:20474.0-20885.0 (median depth 1.0)
[15:04:05 - Sampler] Took 0.00s to make features.
[15:04:05 - PWorker] All done, 0 remainder regions.
[15:04:05 - DLoader] Initializing data loader
[15:04:05 - Sampler] Initializing sampler for consensus of region MN908947.3:22518-22901.
[15:04:05 - PWorker] Running inference for 0.0M draft bases.
[15:04:05 - Feature] Processed MN908947.3:22518.0-22900.0 (median depth 1.0)
[15:04:05 - Sampler] Took 0.00s to make features.
[15:04:05 - PWorker] All done, 0 remainder regions.
[15:04:05 - DLoader] Initializing data loader
[15:04:05 - Sampler] Initializing sampler for consensus of region MN908947.3:28985-29376.
[15:04:05 - PWorker] Running inference for 0.0M draft bases.
[15:04:05 - Feature] Processed MN908947.3:28985.0-29375.0 (median depth 1.0)
[15:04:05 - Sampler] Took 0.00s to make features.
[15:04:05 - PWorker] All done, 0 remainder regions.
[15:04:05 - Predict] Finished processing all regions.
Using medaka stitch to create consensus.
[15:04:06 - DataIndex] Loaded 1/1 (100.00%) sample files.
[15:04:07 - Stitch] Stitching regions: ['MN908947.3:0-']
[15:04:07 - DataIndex] Loaded 1/1 (100.00%) sample files.
[15:04:07 - Stitch] Processing MN908947.3:0-.
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:4046.0-4421.0 and MN908947.3:9216.0-9582.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:9216.0-9582.0 and MN908947.3:10360.0-10523.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:10360.0-10523.0 and MN908947.3:11867.0-12255.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:11867.0-12255.0 and MN908947.3:12423.0-12799.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:12423.0-12799.0 and MN908947.3:13920.0-13983.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:13920.0-13983.0 and MN908947.3:15486.0-15883.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:15486.0-15883.0 and MN908947.3:18643.0-18975.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:18643.0-18975.0 and MN908947.3:20474.0-20885.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:20474.0-20885.0 and MN908947.3:22518.0-22900.0
[15:04:07 - Stitch] There is no overlap betwen MN908947.3:22518.0-22900.0 and MN908947.3:28985.0-29375.0
[15:04:07 - Stitch] Used heuristic 0 times for MN908947.3:0-.
Polished assembly written to results/BC11_polish/medaka/consensus.fasta, have a nice day.
[Tue Oct  5 15:04:07 2021]
Finished job 4.
3 of 5 steps (60%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/simon/smk-artic-ont/smk-artic-ont/.snakemake/log/2021-10-05T150123.202143.snakemake.log
(snakemake) simon@c105:~/smk-artic-ont/smk-artic-ont$ 